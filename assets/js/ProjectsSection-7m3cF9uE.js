import{j as e}from"./index-CnclUYio.js";import{r as t,a as r}from"./charts-Da9JWBQx.js";import"./vendor-DholdlZV.js";import"./parallax-BxANXTDa.js";const i=({activeCategory:i,handleCategoryChange:n,filteredProjects:c,categories:s,scrollDirection:a,visibleSections:o})=>{const[l,d]=t.useState(null),[u,m]=t.useState(""),[p,h]=t.useState(!1),j=t.useRef(null),[f,g]=t.useState(c),[w,v]=t.useState([]),[x,b]=t.useState(new Set),y=t.useRef(null),N=t.useRef(new Map),k=t.useRef(new Map),C=t.useRef(null),S=t.useRef(null),[E,T]=t.useState(!1),R=()=>{l&&!p&&(h(!0),j.current&&window.clearTimeout(j.current),j.current=window.setTimeout(()=>{d(null),m(""),h(!1),j.current=null},250))};t.useEffect(()=>()=>{j.current&&window.clearTimeout(j.current),C.current&&window.clearTimeout(C.current),S.current&&window.clearTimeout(S.current)},[]),t.useEffect(()=>{if(!l)return;const e=e=>{"Escape"===e.key&&R()};return window.addEventListener("keydown",e),()=>window.removeEventListener("keydown",e)},[l]),t.useEffect(()=>{const e=document.body.style.overflow;return document.body.style.overflow=l?"hidden":e||"",()=>{document.body.style.overflow=e||""}},[l]),t.useEffect(()=>{if(t=f,(e=c).length===t.length&&e.every((e,r)=>{var i;return e.title===(null==(i=t[r])?void 0:i.title)}))return;var e,t;E||T(!0);const r=y.current,i=[];if(r){const e=r.getBoundingClientRect();f.forEach(t=>{if(!c.find(e=>e.title===t.title)){const r=N.current.get(t.title);if(r){const n=r.getBoundingClientRect();i.push({project:t,top:n.top-e.top,left:n.left-e.left,width:n.width,height:n.height})}}})}i.length?(v(i),C.current&&window.clearTimeout(C.current),C.current=window.setTimeout(()=>{v([]),C.current=null},280)):v([]);const n=c.filter(e=>!f.find(t=>t.title===e.title));if(n.length){const e=new Set(n.map(e=>e.title));b(e),S.current&&window.clearTimeout(S.current),S.current=window.setTimeout(()=>{b(new Set),S.current=null},320)}else b(new Set);g(c)},[c,f,E]),t.useLayoutEffect(()=>{const e=new Map;N.current.forEach((t,r)=>{if(!t)return;const i=t.getBoundingClientRect();e.set(r,i);const n=k.current.get(r);if(n){const e=n.left-i.left,r=n.top-i.top;(Math.abs(e)>1||Math.abs(r)>1)&&t.animate([{transform:`translate(${e}px, ${r}px)`},{transform:"translate(0, 0)"}],{duration:320,easing:"cubic-bezier(0.4, 0, 0.2, 1)"})}}),k.current=e},[f]);const $=(t,r=!1)=>e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"project-image",children:t.image.startsWith("/")||t.image.startsWith("http")?e.jsx("img",{src:t.image,alt:t.title,className:"project-img",loading:"lazy"}):e.jsx("div",{className:"project-placeholder",children:t.image})}),e.jsxs("div",{className:"project-content",children:[e.jsx("h3",{className:"project-title",children:t.title}),e.jsx("p",{className:"project-description",children:t.description}),e.jsx("button",{type:"button",className:"project-link",onClick:r?void 0:()=>(e=>{j.current&&(window.clearTimeout(j.current),j.current=null),e.image.startsWith("/")||e.image.startsWith("http")?(d(e.image),m(e.title),h(!1)):e.link&&window.open(e.link,"_blank")})(t),tabIndex:r?-1:void 0,"aria-hidden":!!r||void 0,children:"View Project →"})]})]});return e.jsx("section",{id:"projects",className:`projects ${o.has("projects")?"visible":""} ${"up"===a?"scroll-up":""} ${E?"has-filtered":""}`.trim(),children:e.jsxs("div",{className:"container",children:[e.jsx("h2",{className:"fade-in section-title",children:"Featured Projects"}),e.jsx("div",{className:"project-categories",children:s.map(t=>e.jsx("button",{className:"category-btn "+(i===t.id?"active":""),onClick:()=>{var e;(e=t.id)!==i&&n(e)},children:t.name},t.id))}),e.jsxs("div",{className:"projects-grid",ref:y,children:[f.map(t=>{const r=x.has(t.title);return e.jsx("div",{ref:e=>{e?N.current.set(t.title,e):N.current.delete(t.title)},"data-project-id":t.title,className:"project-card "+(r?"card-enter":""),children:$(t)},t.title)}),w.length>0&&e.jsx("div",{className:"project-exit-layer","aria-hidden":"true",children:w.map(t=>e.jsx("div",{className:"project-card exit-card",style:{width:t.width,height:t.height,top:t.top,left:t.left},children:$(t.project,!0)},`exit-${t.project.title}`))})]}),l&&"undefined"!=typeof document&&r.createPortal(e.jsx("div",{className:"project-modal-backdrop "+(p?"closing":"opening"),onClick:R,role:"presentation",children:e.jsxs("div",{className:"project-modal "+(p?"closing":"opening"),role:"dialog","aria-modal":"true","aria-label":`${u} preview`,onClick:e=>e.stopPropagation(),children:[e.jsx("button",{type:"button",className:"project-modal-close",onClick:R,"aria-label":"Close image",children:"×"}),e.jsx("img",{src:l,alt:u,className:"project-modal-image"}),e.jsx("p",{className:"project-modal-caption",children:u})]})}),document.body)]})})};export{i as default};
